<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Хандивын Аяны Вэб</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .gradient-text {
      background: linear-gradient(to right, #e11d48, #c026d3);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .progress-bar {
      background: #f1f5f9;
      border-radius: 9999px;
      overflow: hidden;
      height: 12px;
    }
    
    .progress-fill {
      background: linear-gradient(to right, #e11d48, #c026d3);
      height: 100%;
      transition: width 0.5s ease;
    }
    
    .fade-up {
      opacity: 0;
      transform: translateY(24px);
      animation: fadeUp 0.6s ease forwards;
    }
    
    @keyframes fadeUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .card {
      background: white;
      border-radius: 1rem;
      border: 1px solid #e2e8f0;
      overflow: hidden;
    }
    
    .btn {
      padding: 0.5rem 1rem;
      border-radius: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-primary {
      background: #e11d48;
      color: white;
    }
    
    .btn-primary:hover {
      background: #be123c;
    }
    
    .btn-outline {
      background: white;
      border: 1px solid #e2e8f0;
      color: #334155;
    }
    
    .btn-outline:hover {
      background: #f8fafc;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-white to-slate-50 text-gray-900">
  
  <!-- NAVBAR -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/70 border-b">
    <div class="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <div class="h-8 w-8 rounded-xl bg-rose-600 text-white flex items-center justify-center">
          <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
        </div>
        <span class="font-semibold">Хандивын Аяны Вэб</span>
      </div>
      <nav class="hidden md:flex items-center gap-6 text-sm">
        <a href="campaigns.html" class="hover:text-gray-900">Хандивын аян</a>
        <a href="#howto" class="hover:text-gray-900">Заавар</a>
      </nav>
      <div class="flex items-center gap-2">
        <button id="mobileMenuBtn" class="md:hidden h-9 w-9 inline-flex items-center justify-center rounded-lg border hover:bg-gray-50" aria-label="Цэс нээх">
          <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
        <!-- Auth Button / User Menu -->
        <button id="loginBtn" class="btn btn-outline">Нэвтрэх</button>
        <div id="userMenu" class="hidden items-center gap-2">
          <span id="userName" class="text-sm font-medium"></span>
          <button id="logoutBtn" class="btn btn-outline">Гарах</button>
        </div>
      </div>
    </div>
    <!-- Mobile menu -->
    <div id="mobileMenu" class="md:hidden hidden border-t bg-white/95 backdrop-blur">
      <div class="mx-auto max-w-6xl px-4 py-3 flex flex-col gap-3 text-sm">
        <a href="campaigns.html" class="hover:text-gray-900">Хандивын аян</a>
        <a href="#howto" class="hover:text-gray-900">Заавар</a>
        <button id="mobileLogin" class="text-left text-rose-600">Нэвтрэх</button>
      </div>
    </div>
  </header>

  

  <!-- CAMPAIGНС LIST -->
  <section id="campaignsSection" class="mx-auto max-w-6xl px-4 py-12">
    <div class="fade-up flex items-center justify-between gap-3">
      <div>
        <h2 class="text-3xl md:text-4xl font-bold">Хандивын аян</h2>
        <p class="mt-2 text-gray-600">Дэлгэрэнгүйг харахын тулд дурын аян дээр дарна уу.</p>
      </div>
      <div class="flex items-center gap-2">
        <button id="campPrev" class="h-10 w-10 rounded-full border hover:bg-gray-50 flex items-center justify-center" title="Өмнөх">
          <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
        </button>
        <button id="campNext" class="h-10 w-10 rounded-full border hover:bg-gray-50 flex items-center justify-center" title="Дараах">
          <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        </button>
      </div>
    </div>
    <div id="campaignGrid" class="mt-6 flex gap-4 overflow-x-auto snap-x snap-mandatory sm:grid sm:grid-cols-2 lg:grid-cols-3 sm:gap-6 sm:overflow-visible"></div>
    <div class="mt-6 text-center">
      <a href="campaigns.html" class="inline-flex items-center gap-2 rounded-full border px-4 py-2 text-sm hover:bg-gray-50">Бүх аянуудыг харах
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
      </a>
    </div>
  </section>
  

  <!-- AUTH MODAL -->
  <div id="authModal" class="fixed inset-0 hidden bg-black/50 backdrop-blur-sm z-50 items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-md p-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-semibold" id="authTitle">Нэвтрэх</h3>
        <button id="authClose" class="btn btn-outline">✕</button>
      </div>
      <div id="authContent"></div>
    </div>
  </div>

  <!-- COMPLETED CAMPAIGNS -->
  <section id="completedSection" class="mx-auto max-w-6xl px-4 py-12">
    <div class="fade-up">
      <h2 class="text-3xl md:text-4xl font-bold">Амжилттай болсон аянууд</h2>
      <p class="mt-2 text-gray-600">Зорилгодоо хүрсэн аянууд.</p>
    </div>
    <div id="completedGrid" class="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
  </section>

  <!-- DONATION HISTORY (logged-in only) -->
  <section id="historySection" class="mx-auto max-w-6xl px-4 py-12 hidden">
    <div class="fade-up">
      <h2 class="text-3xl md:text-4xl font-bold">Миний хандивууд</h2>
      <p class="mt-2 text-gray-600">Таны хийсэн хандивын түүх</p>
    </div>
    <div id="historyList" class="mt-6 space-y-3"></div>
  </section>

<section id="howto" class="mx-auto max-w-6xl px-4 py-12">
  <div class="fade-up">
    <h2 class="text-3xl md:text-4xl font-bold">Хэрхэн хандив өгөх вэ?</h2>
    <p class="mt-2 text-gray-600">Дараах алхмуудаар та аюулгүйгээр хандив өгөөрэй.</p>
  </div>
  <div class="mt-6 grid md:grid-cols-4 gap-6">
    <div class="card p-5">
      <div class="text-sm text-gray-600">Алхам 1</div>
      <h3 class="mt-1 font-semibold">Хандив өгөх аянаа сонгох</h3>
      <p class="mt-2 text-gray-600">Одоо идэвхтэй хандивын аянуудыг үзэж хандив өгөх аянаа сонгох.</p>
    </div>
    <div class="card p-5">
      <div class="text-sm text-gray-600">Алхам 2</div>
      <h3 class="mt-1 font-semibold">Дүнгээ оруулж шилжүүлэх</h3>
      <p class="mt-2 text-gray-600">Хүссэн дүнгээ сонгон баталгаажуулж шилжүүлнэ.</p>
    </div>
    <div class="card p-5">
      <div class="text-sm text-gray-600">Алхам 3</div>
      <h3 class="mt-1 font-semibold">Хүлээн зөвшөөрөгдсөн суваг сонгох</h3>
      <p class="mt-2 text-gray-600">Дансны мэдээлэл, QPay, SocialPay гэх мэт албан ёсны сувгуудаас сонгоно.</p>
    </div>
    <div class="card p-5">
      <div class="text-sm text-gray-600">Алхам 4</div>
      <h3 class="mt-1 font-semibold">Хандивын баримтаа хадгалах</h3>
      <p class="mt-2 text-gray-600">Гүйлгээний баримтаа хадгалж, хэрэгцээт мэдээллээ зөв бөглөнө.</p>
    </div>
  </div>
</section>


  <!-- FOOTER -->
  <footer class="border-t">
    <div class="mx-auto max-w-6xl px-4 py-8 flex flex-col md:flex-row items-center justify-between gap-3 text-sm text-gray-600 text-center md:text-left">
      <span class="leading-relaxed">© <span id="currentYear"></span> Хандивын Аян. Бүх эрх хуулиар хамгаалагдсан.</span>
      <div class="flex items-center gap-4 flex-wrap justify-center md:justify-end">
        <a href="#" class="hover:text-gray-900">Нууцлал</a>
        <a href="#" class="hover:text-gray-900">Тайлан</a>
      </div>
    </div>
  </footer>

  <script>
    // LocalStorage keys
    let images = [];
    const LS_USERS = 'users';
    const LS_CURRENT = 'currentUser';
    const LS_CAMPAIGNS = 'campaigns';
    const LS_DONATIONS = 'donations';

    // Format MNT
    function formatMNT(n) {
      return new Intl.NumberFormat('mn-MN').format(n) + ' ₮';
    }

    // Progress demo & hero removed

    // Site-wide share removed

    // Current year
    document.getElementById('currentYear').textContent = new Date().getFullYear();

  // Initialize (gallery removed)

    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });

    // ----- Simple auth modal (login/signup) -----
    const loginBtn = document.getElementById('loginBtn');
    const userMenu = document.getElementById('userMenu');
    const userNameEl = document.getElementById('userName');
    const logoutBtn = document.getElementById('logoutBtn');
    const authModal = document.getElementById('authModal');
    const authContent = document.getElementById('authContent');
    const authTitle = document.getElementById('authTitle');
    const authClose = document.getElementById('authClose');

    function getUsers(){ return JSON.parse(localStorage.getItem(LS_USERS) || '[]'); }
    function saveUsers(u){ localStorage.setItem(LS_USERS, JSON.stringify(u)); }
    function getCurrent(){ return JSON.parse(localStorage.getItem(LS_CURRENT) || 'null'); }
    function setCurrent(u){ localStorage.setItem(LS_CURRENT, JSON.stringify(u)); }

    function openAuth(mode='login'){
      authTitle.textContent = mode === 'login' ? 'Нэвтрэх' : 'Бүртгүүлэх';
      if(mode==='login'){
        authContent.innerHTML = `
          <div class="space-y-3">
            <input id="logEmail" class="w-full rounded-2xl border px-4 py-3 outline-none focus:ring-2 ring-rose-600" placeholder="И-мэйл"/>
            <input id="logPass" type="password" class="w-full rounded-2xl border px-4 py-3 outline-none focus:ring-2 ring-rose-600" placeholder="Нууц үг"/>
            <div class="text-sm text-gray-600">Та бүртгэлгүй юу? <button id="toSignup" class="underline">Бүртгүүлэх</button></div>
            <div class="flex justify-end gap-2">
              <button id="doLogin" class="btn btn-primary">Нэвтрэх</button>
            </div>
          </div>`;
        document.getElementById('toSignup').onclick = ()=>openAuth('signup');
        document.getElementById('doLogin').onclick = ()=>{
          const email = String(document.getElementById('logEmail').value||'').trim();
          const pass = document.getElementById('logPass').value;
          const u = getUsers().find(x=>x.email===email && x.password===pass);
          if(!u){ alert('Нэвтрэх амжилтгүй'); return; }
          setCurrent({name:u.name,email:u.email});
          closeAuth();
          updateAuthUI();
        };
      } else {
        authContent.innerHTML = `
          <div class="space-y-3">
            <input id="regName" class="w-full rounded-2xl border px-4 py-3 outline-none focus:ring-2 ring-rose-600" placeholder="Нэр"/>
            <input id="regEmail" class="w-full rounded-2xl border px-4 py-3 outline-none focus:ring-2 ring-rose-600" placeholder="И-мэйл"/>
            <input id="regPass" type="password" class="w-full rounded-2xl border px-4 py-3 outline-none focus:ring-2 ring-rose-600" placeholder="Нууц үг"/>
            <div class="text-sm text-gray-600">Бүртгэлтэй юу? <button id="toLogin" class="underline">Нэвтрэх</button></div>
            <div class="flex justify-end gap-2">
              <button id="doSignup" class="btn btn-primary">Бүртгүүлэх</button>
            </div>
          </div>`;
        document.getElementById('toLogin').onclick = ()=>openAuth('login');
        document.getElementById('doSignup').onclick = ()=>{
          const name = String(document.getElementById('regName').value||'').trim();
          const email = String(document.getElementById('regEmail').value||'').trim();
          const pass = document.getElementById('regPass').value;
          if(!name||!email||!pass){ alert('Бүх талбар шаардлагатай'); return; }
          const users = getUsers();
          if(users.find(u=>u.email===email)){ alert('Ийм и-мэйл бүртгэлтэй байна'); return; }
          users.push({name,email,password:pass});
          saveUsers(users);
          alert('Бүртгэл амжилттай. Одоо нэвтэрнэ үү.');
          openAuth('login');
        };
      }
      authModal.classList.remove('hidden');
      authModal.classList.add('flex');
    }
    function closeAuth(){ authModal.classList.add('hidden'); authModal.classList.remove('flex'); }
    if(authClose){ authClose.addEventListener('click', closeAuth); }
    if(loginBtn){ loginBtn.addEventListener('click', ()=>openAuth('login')); }

    function updateAuthUI(){
      const current = getCurrent();
      const historySection = document.getElementById('historySection');
      if(current && current.name){
        if(userMenu) userMenu.classList.remove('hidden');
        if(loginBtn) loginBtn.classList.add('hidden');
        if(userNameEl) userNameEl.textContent = current.name;
        if(historySection) historySection.classList.remove('hidden');
        renderHistory();
      } else {
        if(userMenu) userMenu.classList.add('hidden');
        if(loginBtn) loginBtn.classList.remove('hidden');
        if(userNameEl) userNameEl.textContent = '';
        if(historySection) historySection.classList.add('hidden');
      }
      // Always render campaigns for all visitors
      renderCampaigns();
      renderCompleted();
    }
    if (logoutBtn) {
      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem(LS_CURRENT);
        updateAuthUI();
      });
    }

    // ----- Campaigns list & details -----
    function loadCampaigns(){ return JSON.parse(localStorage.getItem(LS_CAMPAIGNS)||'[]'); }
    function saveCampaigns(arr){ localStorage.setItem(LS_CAMPAIGNS, JSON.stringify(arr)); }
    // Ensure we have at least a few completed MEDICAL campaign examples
    function ensureCompletedExamples(minCount=3){
      const items = loadCampaigns();
      const byId = new Set(items.map(c=>String(c.id)));
      const isMedical = (c)=> (c.category === 'Эрүүл мэнд') || !c.category;
      const isCompleted = (c)=> (Number(c.raised)||0) >= (Number(c.goal)||0);
      const currentCompleted = items.filter(c=> isMedical(c) && isCompleted(c));
      if(currentCompleted.length >= minCount) return;
      const need = minCount - currentCompleted.length;
      const base = Date.now();
      const demos = [
        { title:'Яаралтай мэс заслын зардал', desc:'Хүнд байдалд орсон өвчтөнд хийсэн мэс заслын зардлыг бүрэн даах боломж бүрдлээ.', goal:5000000, raised:5000000, image:'https://images.unsplash.com/photo-1584982751601-97dcc096659c?w=800' },
        { title:'Хорт хавдрын эмчилгээний явц', desc:'Хими эмчилгээ, туяа эмчилгээний зардал амжилттай санхүүжлэгдэв.', goal:12000000, raised:12000000, image:'public/hand1.jpeg' },
        { title:'Хүүхдийн элэг шилжүүлэн суулгах дэмжлэг', desc:'Элэг шилжүүлэн суулгах өндөр өртөгтэй мэс заслыг амжилттай санхүүжүүллээ.', goal:80000000, raised:80000000, image:'https://images.unsplash.com/photo-1586773860418-d37222d8fce3?w=800' }
      ];
      let added = 0, i = 0;
      while(added < need && i < demos.length){
        const d = demos[i++];
        const id = 'm' + (base + i);
        if(byId.has(id)) continue;
        items.push({ id, category:'Эрүүл мэнд', ...d });
        added++;
      }
      if(added>0) saveCampaigns(items);
    }

    if(!loadCampaigns().length){
      saveCampaigns([
  {id:1,title:'Бат-Эрдэнийн эмчилгээ',desc:'Яаралтай мэс засал шаардлагатай. Эмчийн бичигтэй.',goal:5000000,raised:1500000,image:'public/hospital1.jpeg'},
        {id:2,title:'Сараагийн эмнэлгийн зардал',desc:'Хүнд онош, нэмэлт шинжилгээ хийх шаардлагатай.',goal:3000000,raised:400000,image:'public/hand1.jpeg'},
        {id:3,title:'Б.Болдын хагалгааны зардал',desc:'Гадаадад эмчилгээ хийлгэх шаардлагатай болсон.',goal:7000000,raised:2200000,image:'https://images.unsplash.com/photo-1526256262350-7da7584cf5eb?w=800'}
      ]);
    }
    // Top up with completed medical examples if needed
    ensureCompletedExamples(3);
    function pct(raised, goal){ const g=Number(goal)||0; return g? Math.min(100, Math.round((Number(raised)||0)/g*100)) : 0; }
    function renderCampaigns(){
      const grid = document.getElementById('campaignGrid');
      if(!grid) return;
      // Show only ACTIVE medical campaigns and limit to first 3
      const items = loadCampaigns()
        .filter(c => (c.category === 'Эрүүл мэнд') || !c.category)
        .filter(c => (Number(c.raised)||0) < (Number(c.goal)||0))
        .slice(0,3);
      grid.innerHTML = items.map(c=>{
        const p = pct(c.raised, c.goal);
        const img = c.image || c.img || '';
        const detailPage = (Number(c.raised)||0) >= (Number(c.goal)||0) ? 'campaign-success.html' : 'campaign.html';
        return `
        <a class="card overflow-hidden hover:shadow-lg transition-shadow block min-w-[260px] sm:min-w-[280px] snap-start" href="${detailPage}?id=${encodeURIComponent(c.id)}">
          <div class="relative h-48 bg-gray-200 overflow-hidden">
            ${img?`<img src="${img}" alt="${c.title}" class="w-full h-full object-cover">`:`<img src="public/image2.jpeg" alt="${c.title}" class="w-full h-full object-cover">`}
            <div class="absolute bottom-3 left-3 bg-black/70 text-white px-3 py-1 rounded-full text-xs sm:text-sm">${p}%</div>
          </div>
          <div class="p-4">
            <h3 class="font-semibold text-base sm:text-lg mb-2">${c.title}</h3>
            <div class="w-full bg-gray-200 rounded-full h-2 sm:h-2.5 mb-2" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="${p}">
              <div class="bg-rose-600 h-2 sm:h-2.5 rounded-full" style="width:${p}%"></div>
            </div>
            <div class="font-semibold">${formatMNT(c.raised)} / ${formatMNT(c.goal)}</div>
          </div>
        </a>`;
      }).join('');
      // Horizontal scroll controls
      const listEl = document.getElementById('campaignGrid');
      const prev = document.getElementById('campPrev');
      const next = document.getElementById('campNext');
      const scrollByAmt = Math.min(900, Math.max(320, listEl.clientWidth * 0.8));
      if(prev) prev.onclick = ()=> listEl.scrollBy({left: -scrollByAmt, behavior:'smooth'});
      if(next) next.onclick = ()=> listEl.scrollBy({left: scrollByAmt, behavior:'smooth'});
    }

    function renderCompleted(){
      const grid = document.getElementById('completedGrid');
      if(!grid) return;
      // Show only COMPLETED medical campaigns and limit to first 3
      const items = loadCampaigns()
        .filter(c => (c.category === 'Эрүүл мэнд') || !c.category)
        .filter(c => (Number(c.raised)||0) >= (Number(c.goal)||0))
        .slice(0,3);
      if(!items.length){
        grid.innerHTML = '<div class="col-span-3 text-gray-500">Одоогоор зорилгодоо бүрэн хүрсэн аян байхгүй.</div>';
        return;
      }
      grid.innerHTML = items.map(c=>{
        const img = c.image || c.img || '';
        const detailPage = 'campaign-success.html';
        return `
        <a class="card overflow-hidden hover:shadow-lg transition-shadow block" href="${detailPage}?id=${encodeURIComponent(c.id)}">
          <div class="relative h-48 bg-gray-200 overflow-hidden">
            ${img?`<img src="${img}" alt="${c.title}" class="w-full h-full object-cover">`:''}
            <div class="absolute bottom-3 left-3 bg-green-600 text-white px-3 py-1 rounded-full text-sm">Амжилттай</div>
          </div>
          <div class="p-4">
            <h3 class="font-semibold text-lg mb-2">${c.title}</h3>
            <div class="font-semibold mb-2">${formatMNT(c.raised)} / ${formatMNT(c.goal)} (100%)</div>
            <div class="w-full bg-gray-200 rounded-full h-2 sm:h-2.5" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100">
              <div class="bg-green-600 h-2 sm:h-2.5 rounded-full" style="width:100%"></div>
            </div>
          </div>
        </a>`;
      }).join('');
    }

    function loadDonations(){ return JSON.parse(localStorage.getItem(LS_DONATIONS)||'[]'); }
    function renderHistory(){
      const list = document.getElementById('historyList');
      if(!list) return;
      const current = getCurrent();
      if(!current) { list.innerHTML=''; return; }
      const all = loadDonations().filter(d=>d.user===current.email).sort((a,b)=>b.at-a.at);
      if(!all.length){
        // Seed a few demo donations for the current user using existing campaigns
        const cams = loadCampaigns();
        const picks = cams.slice(0,2);
        const now = Date.now();
        const demo = picks.map((c,i)=>({ user: current.email, campaignId: c.id, title: c.title, amount: (i?50000:100000), at: now - (i+1)*86400000 }));
        const existing = JSON.parse(localStorage.getItem(LS_DONATIONS)||'[]');
        localStorage.setItem(LS_DONATIONS, JSON.stringify(existing.concat(demo)));
      }
      const refreshed = loadDonations().filter(d=>d.user===current.email).sort((a,b)=>b.at-a.at);
      if(!refreshed.length){
        list.innerHTML = '<div class="text-gray-500">Одоогоор түүх байхгүй.</div>';
        return;
      }
      const byId = Object.fromEntries(loadCampaigns().map(c => [String(c.id), c]));
      list.innerHTML = refreshed.map(d=>{
        const dt = new Date(d.at);
        const when = dt.toLocaleString('mn-MN');
        const c = byId[String(d.campaignId)];
        const success = c && ((Number(c.raised)||0) >= (Number(c.goal)||0));
        const detailPage = success ? 'campaign-success.html' : 'campaign.html';
        return `
          <a class="card p-4 flex items-center justify-between hover:shadow" href="${detailPage}?id=${encodeURIComponent(d.campaignId)}">
            <div>
              <div class="font-medium">${d.title}</div>
              <div class="text-xs text-gray-500">${when}</div>
            </div>
            <div class="text-rose-600 font-semibold">${formatMNT(d.amount)}</div>
          </a>`;
      }).join('');
    }

    // Mobile menu toggle
    const mobileBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileLogin = document.getElementById('mobileLogin');
    if(mobileBtn && mobileMenu){
      mobileBtn.addEventListener('click', ()=>{
        mobileMenu.classList.toggle('hidden');
      });
    }
    if(mobileLogin){ mobileLogin.addEventListener('click', ()=>{ mobileMenu.classList.add('hidden'); openAuth('login'); }); }

    // initialize auth UI on load
    updateAuthUI();
  </script>
</body>
</html>